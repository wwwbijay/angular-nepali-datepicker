<div class="nepali-date-picker" [ngClass]="theme">
  <input
    class="np_datepicker_input"
    type="text"
    [value]="formattedDate"
    (focus)="open()"
    (keydown)="$event.preventDefault()"
    aria-hidden="true"
    [hidden]="hideInput"
  />
  <a (click)="toggleOpen()" [ngClass]="(isOpen)? 'active':''">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
      <path
        d="M152 64H296V24C296 10.75 306.7 0 320 0C333.3 0 344 10.75 344 24V64H384C419.3 64 448 92.65 448 128V448C448 483.3 419.3 512 384 512H64C28.65 512 0 483.3 0 448V128C0 92.65 28.65 64 64 64H104V24C104 10.75 114.7 0 128 0C141.3 0 152 10.75 152 24V64zM48 448C48 456.8 55.16 464 64 464H384C392.8 464 400 456.8 400 448V192H48V448z"
      />
    </svg>
  </a>
  <ng-container [ngTemplateOutlet]="dp" *ngIf="isOpen"></ng-container>
</div>
<!--.nepali-date-picker-->

<ng-template #dp>
  <div class="datepicker__container">
    <div class="datepicker__options-container">
      <span class="datepicker__options-year-container">
        <span> {{ "Year" | toNp: language:"word" }}: </span>
        <select (change)="selectYear($event)">
          <option
            *ngFor="let year of years; index as i"
            [value]="year"
            [selected]="year == currentNepaliDate?.year"
          >
            {{ year | toNp: language:"number" }}
          </option>
        </select>
      </span>
      <span class="datepicker__options-month-container">
        <span>{{ "Month" | toNp: language:"word" }}: </span>
        <select (change)="selectMonth($event)">
          <option
            *ngFor="
              let month of monthsMapping[language][monthDisplayType];
              index as i
            "
            [value]="month"
            [selected]="i === currentNepaliDate?.month"
          >
            {{ month }}
          </option>
        </select>
      </span>
    </div>
    <div class="datepicker__days-container">
      <div
        class="datepicker__days"
        *ngFor="let day of daysMapping[language][dayDisplayType]; index as i"
      >
        <div class="datepicker__weekday">{{ day }}</div>
        <div
          class="datepicker__date-container"
          *ngFor="let date of currentMonthData[i]"
        >
          <div
            *ngIf="date"
            class="datepicker__date"
            [class.datepicker__date--active]="
              date === selectedDate?.day &&
              currentNepaliDate.month === selectedDate?.month &&
              currentNepaliDate.year === selectedDate?.year
            "
            [class.datepicker__date--current-day]="
              date === nepaliDateToday.day &&
              currentNepaliDate.month === nepaliDateToday.month &&
              currentNepaliDate.year === nepaliDateToday.year
            "
            (click)="selectDate(date)"
          >
            {{ date | toNp: language:"number" }}
          </div>
          <div *ngIf="!date" class="datepicker__date--disabled">
            <span>&nbsp;</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>
